      SUBROUTINE PALTAB(PENMAP,RTAB,GTAB,BTAB,NPAL)
C=======================================================================
C
C     DEFINE PALLETTE OF 256 RGB COLORS
C     NPAL  = 1 = MAXIMUM CONTRAST PALLETTE
C          <> 1 = RAINBOW PALLETTE
C
C=======================================================================
      INTEGER R1,G1,B1,R2,G2,B2,PAL1,PAL2,RTAB,GTAB,BTAB,PENMAP
      DIMENSION R1(256),G1(256),B1(256),R2(256),G2(256),B2(256),
     1 RTAB(256),GTAB(256),BTAB(256),PAL1(256),PAL2(256),PENMAP(256)
C-----MAXIMUM CONTRAST PALLETTE
      DATA PAL1/
     1   0, 15, 71, 23, 87,135,231, 39,167,119,215,247,103, 55,151,199,
     2  11,188, 76, 26, 90,138,236, 42,170,124,220,252,108, 60,156,204,
     3  10, 36, 67, 21, 83,131,227, 37,163,115,211,243, 99, 51,147,195,
     4   9,185, 56, 27, 89,137,234, 35,172,122,218,250,106,162,157,205,
     5   8, 92, 58, 25, 91,141,238, 54,136,125,221,253,109, 45,154,206,
     6  12,177, 72, 29, 88,142,237, 53,134,126,222,254,110, 44,153,202,
     7   6, 97, 74, 24,100,140,232, 41,164,123,203, 30, 65,244,155,111,
     8   7,113, 73, 28,101,171,233, 38,149,121,210, 31, 69, 17,152,127,
     9   4, 95, 70, 22,102,133,229, 40,187,120,213, 13, 66, 52,168,143,
     A 183,145, 75, 19, 84,139,217, 34,189,117,201,255, 80, 62,150,158,
     1  79,161, 77, 18,104,173,228, 48,190,116,197,249, 96, 49,169, 93,
     2 208,196, 47, 20,105,174,216, 16,207,114,212,239, 81,  3,184,191,
     3 160,193, 59,224,107,175,235, 64,165,159,226,245, 82, 61,182,144,
     4   5,209, 57,240, 86,166,214, 32,146,112,200,246, 68, 46,181,223,
     5   1,225, 78,241, 85,148,230, 33,130,118,198,248,129, 14,180,192,
     6   2,176, 43,242, 98,132,219, 50,186, 94,194,251,128, 63,179,178/
      DATA R1/
     1  16, 32, 48, 64, 80, 96,112,128,144,160,176,192,208,224,240,255,
     2  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     3  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     4  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     5  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     6  44, 56, 68, 80, 92,104,116,128,142,156,170,184,198,212,226,240,
     7   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     8   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     9   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     A   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     1   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     2   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     3  44, 56, 68, 80, 92,104,116,128,142,156,170,184,198,212,226,240,
     4  66, 84,102,120,138,156,174,192,199,206,213,220,227,234,241,248,
     5  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     6  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255/
      DATA G1/
     1  16, 32, 48, 64, 80, 96,112,128,144,160,176,192,208,224,240,255,
     2   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     3  44, 56, 68, 80, 92,104,116,128,142,156,170,184,198,212,226,240,
     4  66, 84,102,120,138,156,174,192,199,206,213,220,227,234,241,248,
     5  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     6  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     7  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     8  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     9  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     A  66, 84,102,120,138,156,174,192,199,206,213,220,227,234,241,248,
     1  44, 56, 68, 80, 92,104,116,128,142,156,170,184,198,212,226,240,
     2   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     3   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     4   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     5   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     6   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224/
      DATA B1/
     1  16, 32, 48, 64, 80, 96,112,128,144,160,176,192,208,224,240,255,
     2   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     3   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     4   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     5   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     6   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     7   0,  0,  0,  0,  0,  0,  0,  0, 28, 56, 84,112,140,168,196,224,
     8  55, 70, 85,100,115,130,145,160,170,181,191,202,212,223,233,244,
     9  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     A  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     1  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     2  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     3  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     4  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     5  88,112,136,160,184,208,232,255,255,255,255,255,255,255,255,255,
     6  22, 28, 34, 40, 46, 52, 58, 64, 85,106,127,148,169,190,211,232/
C-----RAINBOW PALLETTE
      DATA PAL2/
     1   0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15,
     2  16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
     3  32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
     4  48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63,
     5  64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79,
     6  80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95,
     7  96, 97, 98, 99,100,101,102,103,104,105,106,107,108,109,110,111,
     8 112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,
     9 128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
     A 144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
     1 160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,
     2 176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
     3 192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,
     4 208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
     5 224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
     6 240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255/
      DATA R2/
     1   0,255,240,224,208,192,176,160,144,128,112, 96, 80, 64, 48, 32,
     2 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     3 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     4 255,255,255,255,255,255,255,255,252,246,240,234,228,222,216,210,
     5 204,198,192,186,180,174,168,162,156,150,144,138,132,126,120,114,
     6 108,102, 96, 90, 84, 78, 72, 66, 60, 54, 48, 42, 36, 30, 24, 18,
     7   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     8   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     9   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     A   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     1   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     2  18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96,102,108,
     3 114,120,126,132,138,144,150,156,162,168,174,180,186,192,198,204,
     4 210,216,222,228,234,240,246,252,255,255,255,255,255,255,255,255,
     5 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     6 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255/
      DATA G2/
     1   0,255,240,224,208,192,176,160,144,128,112, 96, 80, 64, 48, 32,
     2  18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96,102,108,
     3 114,120,126,132,138,144,150,156,162,168,174,180,186,192,198,204,
     4 210,216,222,228,234,240,246,252,255,255,255,255,255,255,255,255,
     5 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     6 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     7 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     8 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     9 255,255,255,255,255,255,255,255,252,246,240,234,228,222,216,210,
     A 204,198,192,186,180,174,168,162,156,150,144,138,132,126,120,114,
     1 108,102, 96, 90, 84, 78, 72, 66, 60, 54, 48, 42, 36, 30, 24, 18,
     2   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     3   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     4   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     5   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     6   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0/
      DATA B2/
     1   0,255,240,224,208,192,176,160,144,128,112, 96, 80, 64, 48, 32,
     2   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     3   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     4   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     5   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     6   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     7  18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96,102,108,
     8 114,120,126,132,138,144,150,156,162,168,174,180,186,192,198,204,
     9 210,216,222,228,234,240,246,252,255,255,255,255,255,255,255,255,
     A 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     1 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     2 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     3 255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
     4 255,255,255,255,255,255,255,255,252,246,240,234,228,222,216,210,
     5 204,198,192,186,180,174,168,162,156,150,144,138,132,126,120,114,
     6 108,102, 96, 90, 84, 78, 72, 66, 60, 54, 48, 42, 36, 30, 24, 18/
      IF(NPAL.NE.1) GO TO 20
C-----MAXIMUM CONTRAST PALLETTE
      DO 10 I=1,256
C***** DEBUG
      RTAB(I)=R1(I)
      GTAB(I)=G1(I)
      BTAB(I)=B1(I)
   10 PENMAP(I)=PAL1(I)
c     K=PAL1(I)+1
c     RTAB(I)=R1(K)
c     GTAB(I)=G1(K)
c     BTAB(I)=B1(K)
c  10 PENMAP(I)=I-1
C***** DEBUG
      RETURN
C-----RAINBOW PALLETTE
   20 IF(NPAL.NE.2) GO TO 40
      DO 30 I=1,256
      RTAB(I)=R2(I)
      GTAB(I)=G2(I)
      BTAB(I)=B2(I)
   30 PENMAP(I)=PAL2(I)
      RETURN
C-----SHADING PALLETTE
   40 IF(NPAL.NE.3) GO TO 100
C-----BASIC 16 COLORS
      DO 60 I=1,16
      K=PAL1(I)+1
      RTAB(I)=R1(K)
      GTAB(I)=G1(K)
      BTAB(I)=B1(K)
   60 PENMAP(I)=I-1
      DO 65 I=17,256
   65 PENMAP(I)=I-1
      RGBMULT=1.0
C***** DEBUG
c     DRGBMULT=1.0/27.0
      DRGBMULT=1.0/22.0
C***** DEBUG
      DO 80 I1=17,256,14
      I2=I1+13
      IF(I2.GT.256) I2=256
      KK=3
      RGBMULT=RGBMULT-DRGBMULT
      DO 70 I=I1,I2
      RTAB(I)=RGBMULT*RTAB(KK)
      GTAB(I)=RGBMULT*GTAB(KK)
      BTAB(I)=RGBMULT*BTAB(KK)
   70 KK=KK+1
   80 CONTINUE
  100 RETURN
      END
